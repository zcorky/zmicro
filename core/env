#!/bin/bash

TMP_ZMICRO_CONFIG_PATH=$ZMICRO_HOME/config
TMP_ZMICRO_ZMICRO_CORE_PATH=$ZMICRO_HOME/core
TMP_ZMICRO_PLUGINS_PATH=$ZMICRO_HOME/plugins

# Load Base Config
. $TMP_ZMICRO_CONFIG_PATH/config

# @TODO override ZMICRO_CORE_PATH
export ZMICRO_CORE_PATH=$TMP_ZMICRO_ZMICRO_CORE_PATH
export ZMICRO_PLUGINS_PATH=$TMP_ZMICRO_PLUGINS_PATH

# Load Doreamon Fns
# . $ZMICRO_CORE_PATH/load
# . $CURRENT_DIR/load
\. $TMP_ZMICRO_ZMICRO_CORE_PATH/load

# Load Config in TMP_ZMICRO_CONFIG_PATH
load_config $TMP_ZMICRO_CONFIG_PATH

# Load User Config
# @FIX install step doesnot generate ZMICRO_RC
[[ -f $ZMICRO_RC ]] && load_config $ZMICRO_RC

# Do for mac os
if [ "$(os_is_macos)" = "true" ]; then
  export ZMICRO_APP_LOGS_PATH=$HOME/.local/zmicro/logs
  export ZMICRO_APP_DATA_PATH=$HOME/.local/zmicro/data
fi